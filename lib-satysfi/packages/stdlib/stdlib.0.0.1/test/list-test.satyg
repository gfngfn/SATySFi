use package open Testing
use open Basic
use Int
use Ordering
use List

module ListTest = struct

  val eq-ordering =
    Equality.make (|
      equal = Ordering.equal,
      show = Ordering.show,
    |)

  #[test]
  val compare-test () =
    List.iter (fun r -> (
      let got = List.compare Int.compare r#input1 r#input2 in
      assert-equal ?(title = r#title) eq-ordering r#expected got
    ))
    [
      (|
        title = `prefix is smaller 1`,
        input1 = [],
        input2 = [1],
        expected = Less,
      |),
      (|
        title = `prefix is smaller 2`,
        input1 = [1],
        input2 = [1, 2],
        expected = Less,
      |),
      (|
        title = `prefix is smaller 3`,
        input1 = [2],
        input2 = [2, 1],
        expected = Less,
      |),
      (|
        title = `lexicographic`,
        input1 = [4, 2],
        input2 = [4, 1, 3],
        expected = Greater,
      |),
    ]

  #[test]
  val fold-test () =
    let input = [3, 1, 4, 1, 5, 9, 2] in
    let expected = 25 in
    let got = List.fold ( + ) 0 input in
    assert-equal Equality.int expected got

  % TODO: add more tests

end
