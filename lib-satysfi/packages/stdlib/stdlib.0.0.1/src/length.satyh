module Length :> sig
  type t = length
  val persistent ~max : length -> length -> length
  val persistent ~min : length -> length -> length
  val persistent ~abs : length -> length
end = struct

  type t = length

  val persistent ~max len1 len2 =
    if len1 <' len2 then len2 else len1

  val persistent ~min len1 len2 =
    if len1 <' len2 then len1 else len2

  val persistent ~abs len =
    if len <' 0pt then 0pt -' len else len

end
